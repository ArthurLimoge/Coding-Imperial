---
title: "Extreme value analysis - wind data"
date: "21/10/2019"
---

First import the wind data.
Each line represents a month, from january 1965 to december 1981.

```{r}

wind_data <- read.table("wind.txt", sep = " ")
months <- seq(1, 12, length = 12)
first_col <- rep(months, 17)
cbind(first_col, wind_data) # appends a first column which shows the index of the month

```

Now one draw a histogram of the data to have an idea what we're dealing with.

```{r}

hist(unlist(wind_data[3:33]))

```

Now, we'll want to prove this distribution can be approximated by a Gumbel distribution, with cumulative distribution function $F : x \mapsto \exp(-\exp(-x)), x \in \mathbb{R}$.
Can easily determine the inverse of $F$ to be $x \mapsto -\ln(\ln(\frac{1}{x})), x > 0$.

Therefore, we can use an inverse transform sampling to generate a Gumbel distribution from a uniform one:

```{r}

uniform_data = runif(1e+6, 0, 1)
gumbel_sampling = -log(log(1/uniform_data)) 
hist(gumbel_sampling)

```

Now, let us compare our wind data with this gumbel distribution, through a QQ-plot.

```{r}

qqplot(unlist(wind_data[3:33]), gumbel_sampling)
qqline(gumbel_sampling, col = "red")

```