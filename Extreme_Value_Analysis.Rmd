---
title: "Extreme value analysis - wind data"
date: "21/10/2019"
author: "Arthur Limoge"
---

First import the wind data ("wind.text" on github).
Each line represents a month, from january 1965 to december 1981.

```{r}
wind_data <- read.table("wind.txt", sep = " ")
months <- seq(1, 12, length = 12)
first_col <- rep(months, 17)
cbind(first_col, wind_data) # appends a first column which shows the index of the month
```

Now one can draw a histogram of the data to have an idea what we're dealing with.

```{r}
wind_list <- unlist(wind_data[3:33])
wind_mean <- mean(wind_list)
wind_sd <- sd(wind_list)

hist(wind_list, main = "Wind data histogram", xlab = "Daily maximum wind speeds")
```

Now, this histogram leads us to think the data can be approximated by a gumbel distribution, often used in Extreme Value Analysis. We can check so by generating a gumbel sampling with the right parameters, and then studying the QQ-plot.

```{r}
scale <- sqrt(6)*wind_sd/pi # computes the scale parameter from the standard deviation
gamma <- -digamma(1) # instanciates the Euler-Mascheroni constant, used to compute the location
location <- wind_mean - scale*gamma

gumbel_sampling = qgumbel(ppoints(204), loc = location, scale = scale)

qqplot(gumbel_sampling, wind_list, xlab = "Experimental wind data", ylab = "Gumbel sample")
qqline(wind_list, distribution = function(p) qgumbel(p, loc = location, scale = scale), col = "red")
```

The QQ-plot is quite accurate, so the wind maximal speeds do follow a Gumbel distribution.
Let us now have a look at the monthly mean of the maximum wind speeds:

```{r}

number_months <- length(wind_data[, 1])
mean_vector <- c()

for (i in seq(1, number_months, length = number_months)){
  mean_vector[i] <- mean(unlist(wind_data[i, ][3:33]))
}

mean_mean <- mean(mean_vector)
mean_sd <- sd(mean_vector)

hist(mean_vector, main = "Average monthly (max.) speeds", xlab = "Speeds")


```

This looks like a Gamma distribution, which we can check by getting the scale and rate parameters and drawing a QQ-plot.

```{r}

beta <- mean_mean/(mean_sd^2)
alpha <- beta*mean_mean
gamma_sampling = qgamma(ppoints(204), shape = alpha, rate = beta)

qqplot(gamma_sampling, mean_vector, xlab = "Gamma sampling", ylab = "Experimental sample")
qqline(mean_vector, distribution = function(p) qgamma(p, shape = alpha, rate = beta), col = "red")

```

Finally, we can try and see if the monthly maximum speeds follow any particular pattern. 

```{r}

maximum_vector <- c()
for (i in seq(1, number_months, length = number_months)){
  maximum_vector[i] <- max(wind_data[i, ][3:33])
}

max_mean = mean(maximum_vector)
max_sd = sd(maximum_vector)

hist(maximum_vector, main = "Maximal speeds per month", xlab = "Speeds")

```

This also seems to follow a Gumbel distribution. We can check this, once again, by studying the QQ-plot.

```{r}

scale <- sqrt(6)*max_sd/pi # computes the scale parameter from the standard deviation
location <- max_mean - scale*gamma

gumbel_sampling = qgumbel(ppoints(204), loc = location, scale = scale)

qqplot(gumbel_sampling, maximum_vector, xlab = "Experimental maximal speeds", ylab = "Gumbel sample")
qqline(maximum_vector, distribution = function(p) qgumbel(p, loc = location, scale = scale), col = "red")

```

The plot is not nearly as accurate as the previous ones. The Gumbel approximation only seems to be valid 
up to a certain point. We can try to study the data with other patterns. [Open to suggestions]
